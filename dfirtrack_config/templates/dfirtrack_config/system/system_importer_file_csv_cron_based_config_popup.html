<!-- extending maintemplate -->
{% extends "dfirtrack_main/mainpopup.html" %}

<!-- HTML head in maintemplate -->
{% block head %}

<!-- page title -->
<title>
    System CSV file import config (cron-based)
</title>

{% load static %}

<!-- HTML head in maintemplate -->
{% endblock %}

<!-- ############################################ -->

<!-- HTML body in maintemplate -->
{% block content %}

<!-- headline -->
<div class="row col bottom-distance">
    <h4>
        System CSV file import config (cron-based)
    </h4>
</div>

<!-- explanation text -->
<div class="row">
    <div class="col">
        <div class="card card-body bg-dark border-light top-distance bottom-distance copy-false">
            You can choose how different system attributes are handled during automatic CSV file import.
        </div>
    </div>
</div>

<!-- form -->
<form method="POST" class="post-form">

    {% csrf_token %}

    <!-- show form related errors -->
    {% include "dfirtrack_main/includes/form_errors.html" %}

    <!-- outer row -->
    <div class="row">

    <!-- TODO: fix arrangement of blocks / cards -->

        <!-- left column -->
        <div class="col-4">

            <!-- CSV file options settings block -->
            <div class="row">

                <div class="card card-body bg-dark border-light top-distance">

                    <h5 class="top-distance">
                        CSV file options
                    </h5>

                    <!-- errors -->
                    <div class="row">
                        <div class="text-danger">
                            {{ form.csv_import_path.errors }}
                        </div>
                    </div>

                    <!-- csv_import_path -->
                    <div class="row">

                        <div class="col top-distance">
                            {{ form.csv_import_path.label }}
                        </div>

                    </div>

                    <div class="row">

                        <div class="col-12 top-distance">
                            {{ form.csv_import_path }}
                        </div>

                    <!-- csv_import_path -->
                    </div>

                    <!-- csv_import_filename -->
                    <div class="row">

                        <div class="col top-distance">
                            {{ form.csv_import_filename.label }}
                        </div>

                    </div>

                    <div class="row">

                        <div class="col-12 top-distance">
                            {{ form.csv_import_filename }}
                        </div>

                    <!-- csv_import_filename -->
                    </div>

                    <!-- csv_field_delimiter / csv_text_quote / csv_headline -->
                    <div class="row">

                        <div class="col-4 top-distance">
                            {{ form.csv_field_delimiter.label }}
                        </div>

                        <div class="col-4 top-distance">
                            {{ form.csv_text_quote.label }}
                        </div>

                        <div class="col-4 top-distance">
                            {{ form.csv_headline.label }}
                        </div>

                    </div>

                    <div class="row">

                        <div class="col-4 top-distance">
                            {{ form.csv_field_delimiter }}
                        </div>

                        <div class="col-4 top-distance">
                            {{ form.csv_text_quote }}
                        </div>

                        <div class="col-4 top-distance">
                            {{ form.csv_headline }}
                        </div>

                    <!-- csv_field_delimiter / csv_text_quote / csv_headline -->
                    </div>

                    <!-- csv_import_username -->
                    <div class="row">

                        <div class="col top-distance">
                            {{ form.csv_import_username.label }}
                        </div>

                    </div>

                    <!-- errors -->
                    <div class="row">
                        <div class="col-6 text-danger">
                            {{ form.csv_import_username.errors }}
                        </div>
                    </div>

                    <div class="row">

                        <div class="col top-distance">
                            {% for i in form.csv_import_username %}
                                {{ i }}<br>
                            {% endfor %}
                        </div>

                    <!-- csv_import_username -->
                    </div>

                </div>

            <!-- CSV file options settings block -->
            </div>

        <!-- left column -->
        </div>

        <!-- middle column -->
        <div class="col-4">

            <!-- important import settings block -->
            <div class="card card-body bg-dark border-light top-distance">

                <h5>
                    Important import settings
                </h5>

                <!-- system -->
                <h6 class="top-distance">
                    Systems
                </h6>

                <div class="text-danger">
                    {{ form.csv_column_system.errors }}
                </div>

                <div class="row">
                    <div class="col-2">
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_system.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_system }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-6 top-distance">
                        {{ form.csv_skip_existing_system.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-6 top-distance">
                        {{ form.csv_skip_existing_system }}
                    </div>
                </div>

                <!-- ip -->
                <h6 class="top-distance">
                    IP addresses
                </h6>

                <!-- errors -->
                <div class="text-danger">
                    {{ form.csv_choice_ip.errors }}
                    {{ form.csv_column_ip.errors }}
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_ip.label }}
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_ip.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_ip }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_ip }}
                    </div>
                </div>

                <!-- csv_remove_ip / csv_ip_delimiter -->
                <div class="row">
                    <div class="col-6 top-distance">
                        {{ form.csv_remove_ip.label }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_ip_delimiter.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_ip.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-6 top-distance">
                        {{ form.csv_remove_ip }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_ip_delimiter }}
                    </div>
                </div>

                <!-- systemstatus -->
                <h6 class="top-distance">
                    Systemstatus (*)
                </h6>

                <div class="row">
                    <div class="col-6">
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_systemstatus.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-6">
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_systemstatus }}
                    </div>
                </div>

                <!-- analysisstatus -->
                <h6 class="top-distance">
                    Analysisstatus (*)
                </h6>

                <div class="row">
                    <div class="col-6">
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_analysisstatus.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-6">
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_analysisstatus }}
                    </div>
                </div>

                <!-- tag -->
                <h6 class="top-distance">
                    Tags
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_tag.errors }}
                        {{ form.csv_column_tag.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_tag.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_tag.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_tag.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_tag }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_tag }}
                    </div>
                    <div class="col-6 top-distance">
                        {% for i in form.csv_default_tag %}
                            {{ i }}<br>
                        {% endfor %}
                    </div>
                </div>

                <!-- csv_remove_tag / csv_tag_delimiter -->
                <div class="row">
                    <div class="col-6 top-distance">
                        {{ form.csv_remove_tag.label }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_tag_delimiter.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_tag.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-6 top-distance">
                        {{ form.csv_remove_tag }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_tag_delimiter }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger top-distance">
                        {{ form.csv_tag_prefix.errors }}
                    </div>
                </div>

                <!-- csv_tag_prefix / csv_tag_prefix_delimiter -->
                <div class="row">
                    <div class="col-6 top-distance">
                        {{ form.csv_tag_prefix.label }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_tag_prefix_delimiter.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-6 top-distance">
                        {{ form.csv_tag_prefix }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_tag_prefix_delimiter }}
                    </div>
                </div>

            <!-- important import settings block -->
            </div>

        <!-- middle column -->
        </div>

        <!-- right column -->
        <div class="col-4">

            <!-- optional import settings block -->
            <div class="card card-body bg-dark border-light top-distance">

                <h5>
                    Optional import settings
                </h5>

                The following settings will be used for cron-based system CSV file import.
                Attributes can be set either via the file or from existing elements of the database.
                Be aware that in the latter case, the corresponding attribute is set for all systems.

                <!-- dnsname -->
                <h6 class="top-distance">
                    DNS name
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_dnsname.errors }}
                        {{ form.csv_column_dnsname.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_dnsname.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_dnsname.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_dnsname.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_dnsname }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_dnsname }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_dnsname }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_dnsname.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_dnsname.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_dnsname }}
                    </div>
                </div>

                <!-- domain -->
                <h6 class="top-distance">
                    Domain
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_domain.errors }}
                        {{ form.csv_column_domain.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_domain.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_domain.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_domain.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_domain }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_domain }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_domain }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_domain.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_domain.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_domain }}
                    </div>
                </div>

                <!-- location -->
                <h6 class="top-distance">
                    Location
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_location.errors }}
                        {{ form.csv_column_location.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_location.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_location.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_location.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_location }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_location }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_location }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_location.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_location.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_location }}
                    </div>
                </div>

                <!-- os -->
                <h6 class="top-distance">
                    OS
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_os.errors }}
                        {{ form.csv_column_os.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_os.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_os.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_os.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_os }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_os }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_os }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_os.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_os.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_os }}
                    </div>
                </div>

                <!-- reason -->
                <h6 class="top-distance">
                    Reason
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_reason.errors }}
                        {{ form.csv_column_reason.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_reason.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_reason.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_reason.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_reason }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_reason }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_reason }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_reason.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_reason.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_reason }}
                    </div>
                </div>

                <!-- recommendation -->
                <h6 class="top-distance">
                    Recommendation
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_recommendation.errors }}
                        {{ form.csv_column_recommendation.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_recommendation.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_recommendation.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_recommendation.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_recommendation }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_recommendation }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_recommendation }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_recommendation.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_recommendation.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_recommendation }}
                    </div>
                </div>

                <!-- serviceprovider -->
                <h6 class="top-distance">
                    Serviceprovider
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_serviceprovider.errors }}
                        {{ form.csv_column_serviceprovider.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_serviceprovider.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_serviceprovider.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_serviceprovider.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_serviceprovider }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_serviceprovider }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_serviceprovider }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_serviceprovider.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_serviceprovider.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_serviceprovider }}
                    </div>
                </div>

                <!-- systemtype -->
                <h6 class="top-distance">
                    Systemtype
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_systemtype.errors }}
                        {{ form.csv_column_systemtype.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_systemtype.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_systemtype.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_systemtype.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_systemtype }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_systemtype }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_systemtype }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_systemtype.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_systemtype.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_systemtype }}
                    </div>
                </div>

                <!-- case -->
                <h6 class="top-distance">
                    Cases
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_case.errors }}
                        {{ form.csv_column_case.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_case.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_case.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_case.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_case }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_case }}
                    </div>
                    <div class="col-6 top-distance">
                        {% for i in form.csv_default_case %}
                            {{ i }}<br>
                        {% endfor %}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_case.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_case.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_case }}
                    </div>
                </div>

                <!-- company -->
                <h6 class="top-distance">
                    Companies
                </h6>

                <!-- errors -->
                <div class="row">
                    <div class="text-danger">
                        {{ form.csv_choice_company.errors }}
                        {{ form.csv_column_company.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_company.label }}
                    </div>
                    <div class="col-3">
                        {{ form.csv_column_company.label }}
                    </div>
                    <div class="col-1">
                        {% include "dfirtrack_config/includes/button_or.html" %}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_company.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_company }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_company }}
                    </div>
                    <div class="col-6 top-distance">
                        {% for i in form.csv_default_company %}
                            {{ i }}<br>
                        {% endfor %}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_company.label }}
                    </div>
                </div>

                <!-- errors -->
                <div class="row">
                    <div class="col-6 text-danger">
                        {{ form.csv_remove_company.errors }}
                    </div>
                </div>

                <div class="row">
                    <div class="col top-distance">
                        {{ form.csv_remove_company }}
                    </div>
                </div>

            <!-- optional import settings block -->
            </div>

        <!-- right column -->
        </div>

    <!-- outer row -->
    </div>

    <!-- button row -->
    <div class="row top-distance">

        <!-- save button -->
        <div class="col-2">
            {% include "dfirtrack_main/includes/button_save.html" %}
        </div>

        <!-- cancel button -->
        <div class="col-1">
            {% include "dfirtrack_main/includes/button_cancel_popup.html" %}
        </div>

    <!-- button row -->
    </div>

<!-- form -->
</form>

<!-- HTML body in maintemplate -->
{% endblock %}
