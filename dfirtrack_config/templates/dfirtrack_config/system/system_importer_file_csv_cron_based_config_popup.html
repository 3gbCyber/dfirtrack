<!-- extending maintemplate -->
{% extends "dfirtrack_main/mainpopup.html" %}

<!-- HTML head in maintemplate -->
{% block head %}

<!-- page title -->
<title>
    System CSV file import config (cron-based)
</title>

{% load static %}

<!-- HTML head in maintemplate -->
{% endblock %}

<!-- ############################################ -->

<!-- HTML body in maintemplate -->
{% block content %}

<!-- headline -->
<div class="row col bottom-distance">
    <h4>
        System CSV file import config (cron-based)
    </h4>
</div>

<!-- explanation text -->
<div class="row">
    <div class="col">
        <div class="card card-body bg-dark border-light top-distance bottom-distance copy-false">
            You can choose how different system attributes are handled during automatic CSV file import.
        </div>
    </div>
</div>

<!-- form -->
<form method="POST" class="post-form">

    {% csrf_token %}

    <!-- show form related errors -->
    {% include "dfirtrack_main/includes/form_errors.html" %}

    <!-- outer row -->
    <div class="row">

    <!-- TODO: fix arrangement of blocks / cards -->

        <!-- left column -->
        <div class="col-4">

            <!-- general settings block -->
            <div class="row">

                <div class="card card-body bg-dark border-light top-distance">

                    <h5>
                        General settings
                    </h5>

                    <table>
                        <tr><td>{{ form.csv_skip_existing_system }}</td> <td>{{ form.csv_skip_existing_system.label }}</td></tr>
                        <tr><td>{{ form.csv_column_system }}</td> <td>{{ form.csv_column_system.label }}</td></tr>
                        <tr><td>{{ form.csv_headline }}</td> <td>{{ form.csv_headline.label }}</td></tr>
                    </table>

                    <h5 class="top-distance">
                        CSV file options
                    </h5>

                    <!-- csv_import_path -->
                    <div class="row">

                        <div class="col top-distance bottom-distance">
                            {{ form.csv_import_path.label }}
                        </div>

                    </div>

                    <div class="row">

                        <div class="col-12">
                            {{ form.csv_import_path }}
                        </div>

                    <!-- csv_import_path -->
                    </div>

                    <!-- csv_import_filename -->
                    <div class="row">

                        <div class="col top-distance bottom-distance">
                            {{ form.csv_import_filename.label }}
                        </div>

                    </div>

                    <div class="row">

                        <div class="col-12">
                            {{ form.csv_import_filename }}
                        </div>

                    <!-- csv_import_filename -->
                    </div>

                    <h5 class="top-distance">
                        User context
                    </h5>

                    <!-- csv_import_username -->
                    <div class="row">

                        <div class="col top-distance bottom-distance">
                            {{ form.csv_import_username.label }}
                        </div>

                    </div>

                    <div class="row">

                        <div class="col-12">
                            {% for i in form.csv_import_username %}
                                {{ i }}<br>
                            {% endfor %}
                        </div>

                    <!-- csv_import_username -->
                    </div>

                </div>

            <!-- general settings block -->
            </div>

            <!-- IP related settings block -->
            <div class="row">

                <div class="card card-body bg-dark border-light top-distance">

                    <h5>
                        IP related settings
                    </h5>

                    <table class="bottom-distance">
                        <tr><td>{{ form.csv_choice_ip }}</td> <td>{{ form.csv_choice_ip.label }}</td></tr>
                    </table>

                    The following settings are only taken into account if IP addresses have been selected.

                    <table class="top-distance">
                        <tr><td>{{ form.csv_remove_ip }}</td> <td>{{ form.csv_remove_ip.label }}</td></tr>
                        <tr><td>{{ form.csv_column_ip }}</td> <td>{{ form.csv_column_ip.label }}</td></tr>
                    </table>

                </div>

            <!-- IP related settings block -->
            </div>

            <!-- overriding settings block -->
            <div class="row">

                <div class="card card-body bg-dark border-light top-distance">

                    <h5>
                        Overriding settings
                    </h5>

                    The following settings will remove existing many-to-many relationships, before adding new ones (only applies for already existing systems).

                    <table class="top-distance">
                        <tr><td>{{ form.csv_remove_case }}</td> <td>{{ form.csv_remove_case.label }}</td></tr>
                        <tr><td>{{ form.csv_remove_company }}</td> <td>{{ form.csv_remove_company.label }}</td></tr>
                        <tr><td>{{ form.csv_remove_tag }}</td> <td>{{ form.csv_remove_tag.label }}</td></tr>
                    </table>

                </div>

            <!-- overriding settings block -->
            </div>

        <!-- left column -->
        </div>

        <!-- middle column -->
        <div class="col-4">

            <!-- cron based settings block -->
            <div class="card card-body bg-dark border-light top-distance">

                <h5>
                    Mandatory settings
                </h5>

                The following settings will be used for cron-based system CSV file import.

                <!-- systemstatus -->

                <h6 class="top-distance">
                    {{ form.csv_default_systemstatus.label }}
                </h6>

                {% for i in form.csv_default_systemstatus %}
                    {{ i }}<br>
                {% endfor %}

                <!-- analysisstatus -->

                <h6 class="top-distance">
                    {{ form.csv_default_analysisstatus.label }}
                </h6>

                {% for i in form.csv_default_analysisstatus %}
                    {{ i }}<br>
                {% endfor %}

            </div>
            <!-- cron based settings block -->

        <!-- middle column -->
        </div>

        <!-- right column -->
        <div class="col-4">

            <div class="card card-body bg-dark border-light top-distance">

                <h5>
                    Optional settings
                </h5>

                The following settings will be used for cron-based system CSV file import.
                Attributes can be set either via the file or from existing elements of the database.
                In the latter case, the corresponding attribute is set for all systems.

                <!-- dnsname -->
                <h6 class="top-distance">
                    DNS name
                </h6>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_dnsname.label }}
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_dnsname.label }}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_dnsname.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_dnsname }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_dnsname }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_dnsname }}
                    </div>
                </div>

                <!-- domain -->
                <h6 class="top-distance">
                    Domain
                </h6>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_domain.label }}
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_domain.label }}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_domain.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_domain }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_domain }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_domain }}
                    </div>
                </div>

                <!-- location -->
                <h6 class="top-distance">
                    Location
                </h6>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_location.label }}
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_location.label }}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_location.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_location }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_location }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_location }}
                    </div>
                </div>

                <!-- os -->
                <h6 class="top-distance">
                    OS
                </h6>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_os.label }}
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_os.label }}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_os.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_os }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_os }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_os }}
                    </div>
                </div>

                <!-- reason -->
                <h6 class="top-distance">
                    Reason
                </h6>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_reason.label }}
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_reason.label }}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_reason.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_reason }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_reason }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_reason }}
                    </div>
                </div>

                <!-- recommendation -->
                <h6 class="top-distance">
                    Recommendation
                </h6>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_recommendation.label }}
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_recommendation.label }}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_recommendation.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_recommendation }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_recommendation }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_recommendation }}
                    </div>
                </div>

                <!-- serviceprovider -->
                <h6 class="top-distance">
                    Serviceprovider
                </h6>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_serviceprovider.label }}
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_serviceprovider.label }}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_serviceprovider.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_serviceprovider }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_serviceprovider }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_serviceprovider }}
                    </div>
                </div>

                <!-- systemtype -->
                <h6 class="top-distance">
                    Systemtype
                </h6>

                <div class="row">
                    <div class="col-2">
                        {{ form.csv_choice_systemtype.label }}
                    </div>
                    <div class="col-4">
                        {{ form.csv_column_systemtype.label }}
                    </div>
                    <div class="col-6">
                        {{ form.csv_default_systemtype.label }}
                    </div>
                </div>

                <div class="row">
                    <div class="col-2 top-distance">
                        {{ form.csv_choice_systemtype }}
                    </div>
                    <div class="col-4 top-distance">
                        {{ form.csv_column_systemtype }}
                    </div>
                    <div class="col-6 top-distance">
                        {{ form.csv_default_systemtype }}
                    </div>
                </div>

                <!-- case -->

                <div class="top-distance">
                    {{ form.csv_default_case.label }}
                </div>

                {% for i in form.csv_default_case %}
                    {{ i }}<br>
                {% endfor %}

                <!-- company -->

                <div class="top-distance">
                    {{ form.csv_default_company.label }}
                </div>

                {% for i in form.csv_default_company %}
                    {{ i }}<br>
                {% endfor %}

                <!-- tag -->

                <div class="top-distance">
                    {{ form.csv_default_tag.label }}
                </div>

                {% for i in form.csv_default_tag %}
                    {{ i }}<br>
                {% endfor %}

            </div>

        <!-- right column -->
        </div>

    <!-- outer row -->
    </div>

    <!-- button row -->
    <div class="row top-distance">

        <!-- save button -->
        <div class="col-2">
            {% include "dfirtrack_main/includes/button_save.html" %}
        </div>

        <!-- cancel button -->
        <div class="col-1">
            {% include "dfirtrack_main/includes/button_cancel_popup.html" %}
        </div>

    <!-- button row -->
    </div>

<!-- form -->
</form>

<!-- HTML body in maintemplate -->
{% endblock %}
